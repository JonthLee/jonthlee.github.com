[{"title":"VirtulaBox + Vagrant——Linux虚拟环境好伴侣","date":"2017-03-13T16:09:53.000Z","path":"virtual-linux/","text":"作为一个苦逼的程序猿，避免不了要接触Linux系统，但对于从小被Windows系统教育起来的人来说，一时之间难以接受Linux的操作管理方式，再加上部分常用软件没有Linux版本，所以要完全将系统切换到Linux上就着实有点困难了。简单粗暴的解决方式就是拜苹果教，既可以体验炫酷的UI，也可以逐步了解到命令行的魅力。除此之外，就需要在本地Windows系统搭建一个Linux虚拟机，来模拟代码在线上生产环境的运行状态。可用的虚拟软件也有挺多，为什么选择VirtualBox和Vagrant呢？两个软件都是开源免费，跨平台的，而且使用她们可以简单快速的搭建虚拟环境，同时对虚拟环境的管理也十分方便，而且网上还有根据不同开发环境制作的box虚拟镜像可供选择，比去下原始的系统镜像文件要方便。 安装首先去VirtualBox和Vagrant官网下载最新版本的软件。 VirtualBox：https://www.virtualbox.org Vagrant：https://www.vagrantup.com 点击下载按钮，根据当前系统平台选择软件版本，进行下载。这里我们都选windows就行，然后就静静地等他下载完成，双击打开，开始安装，一路next，选择下安装目录，等待安装完成。完成后，打开cmd或者PowerShell，执行以下命令：1vagrant -v 会输出vagrant的版本号，这里我安装的版本为1.9.1：1Vagrant 1.9.1 证明Vagrant已安装完成，并且Vagrant命令已添加到环境变量path中。如果提示“’vagrant’ 不是内部或外部命令，也不是可运行的程序或批处理文件。”，则表明vagrant命令没有添加到path中，需要手动添加。右键桌面我的电脑-&gt;属性-&gt;高级系统设置-&gt;环境变量，在系统变量中找到path，选中，点击编辑，将Vagrant安装目录的bin路径添加到path中，我的Vagrant安装在E:\\vagrant中，添加后如下：然后点击确定，重启下电脑，再重新执行以上命令，查看是否正常显示。 初始化接下来需要下载Vagrant Box虚拟镜像，首先到Vagrant Box网站 https://atlas.hashicorp.com/boxes/search 搜索需要的box。这里以搜索centos，按下载量排序为例：可以选择自己需要的点击进去，查看该box的具体使用和各版本发行介绍。我们以bento/centos-7.2来初始化我们的虚拟环境。先新建一个文件夹来存放虚拟文件1mkdir CentOS7.2 然后进入该文件夹，初始化配置文件12cd CentOS7.2vagrant init bento/centos-7.2 会有以下输出1A `Vagrantfile` has been placed in this directory. You are now ready to `vagrant up` your first virtual environment! Please read the comments in the Vagrantfile as well as documentation on `vagrantup.com` for more information on using Vagrant. 这时CentOS7.2下会生成一个文件Vagrantfile，这样就初始化完成了。 配置用记事本或其他编辑器打开Vagrantfile，修改配置。首先配置一下共享目录，这样我们就可以用主机来修改文件，编写代码，虚拟机就可以共享这些文件及修改了。找到1# config.vm.synced_folder \"../data\", \"/vagrant_data\" 去掉注释，将”../data”，修改为你主机想共享的目录，将”/vagrant_data”修改为虚拟机想挂载的目录即可，如：1config.vm.synced_folder \"d:/vagrant\", \"/vagrant\" 如果是做web开发，还需要配置一下如何用浏览器访问虚拟机，有三种方法，如果想给Vagrant Box分配一个只能主机访问的ip，找到1# config.vm.network \"private_network\", ip: \"192.168.33.10\" 去掉前面的#号，自定义一下ip地址即可。如果想让局域网内的电脑都可以访问，那么找到1# config.vm.network \"public_network\" 去掉注释，Vagrant Box会获得一个和主机同处一个网段的ip地址。不想分配ip，也可以，找到1# config.vm.network \"forwarded_port\", guest: 80, host: 8080 给Vagrant Box开放一个主机端口host，再配置一下虚拟机端口guset。我使用的是第一种方法：1config.vm.network \"private_network\", ip: \"192.168.33.10\" 至此，我们的配置修改就已完成，记得保存文件！其他的配置可以参考Vagrantfile上的说明或者去官网了解。 启动打开cmd或者PowerShell，进入centos7.2文件夹，启动Vagrant Box12cd e:/CentOS7.2vagrant up --provider virtualbox 等待box下载，启动完成即可。可以趁着这段时间，再去下个Putty或者XShell免费版，用于连接虚拟机。当命令执行完成后，虚拟机就已经启动完成。注意以下输出信息12default: SSH address: 127.0.0.1:2200default: SSH username: vagrant 这是使用Putty或者XShell通过ssh连接虚拟机的ip及端口号，你的可能是127.0.0.1:2222。ssh默认的用户名和密码都是vagrant。 连接 Putty双击打开Putty，配置好ssh连接的ip和端口，点击open，弹出的对话框选择“是”，然后输入用户名和密码，即可成功登陆。 XShell点击菜单栏的文件，点击新建，弹出新建对话弹窗，名称随便写一个就好，主机和端口号根据vagrant up的输出信息填写，点击确定，完成配置。再点击文件，打开，选中刚才配置的ssh，点击连接，在弹出的弹窗中输入用户名，密码。登陆成功，查看下系统版本 连接成功后，就可以做一下web服务的配置了，详细参考PHP虚拟机开发环境搭建(LNMP和LAMP)。 常用Vagrant命令 帮助 1vagrant help 关闭 1vagrant halt 重启 1vagrant reload 暂停 1vagrant suspend 查看本地已安装的box 1vagrant box list 还有一些其他命令可以使用Vagrant的帮助命令来查看如何使用，或者去官网了解。","tags":[{"name":"Linux","slug":"Linux","permalink":"https://jonthlee.github.io/tags/Linux/"}]}]